{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Container,Typography,Box,Paper,Divider,Button,Grid,TextField,MenuItem,CircularProgress,Alert,Snackbar,FormControl,InputLabel,Select}from'@mui/material';import{useNavigate,useLocation}from'react-router-dom';import axios from'axios';import{useAuth}from'../../contexts/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ReportScreen=()=>{const navigate=useNavigate();const location=useLocation();const{user}=useAuth();const queryParams=new URLSearchParams(location.search);// Get entity type and ID from URL params if available\nconst entityType=queryParams.get('type')||'';const entityId=queryParams.get('id')||'';const[reportType,setReportType]=useState('');const[reportDescription,setReportDescription]=useState('');const[loading,setLoading]=useState(false);const[entityData,setEntityData]=useState(null);const[loadingEntity,setLoadingEntity]=useState(false);const[error,setError]=useState(null);const[success,setSuccess]=useState(false);useEffect(()=>{if(entityType&&entityId){fetchEntityDetails();}},[entityType,entityId]);const fetchEntityDetails=async()=>{try{setLoadingEntity(true);setError(null);let endpoint;switch(entityType.toLowerCase()){case'event':endpoint=`/api/events/${entityId}`;break;case'user':endpoint=`/api/users/${entityId}`;break;case'product':endpoint=`/api/products/${entityId}`;break;case'review':endpoint=`/api/reviews/${entityId}`;break;default:throw new Error('Unknown entity type');}const{data}=await axios.get(endpoint);setEntityData(data);}catch(err){setError(`Failed to fetch ${entityType} details: ${err.message}`);}finally{setLoadingEntity(false);}};const handleSubmitReport=async e=>{e.preventDefault();if(!reportType||!reportDescription.trim()){setError('Please fill in all required fields');return;}try{setLoading(true);setError(null);await axios.post('/api/reports',{entityType,entityId,reportType,description:reportDescription});setSuccess(true);setReportType('');setReportDescription('');// Automatically navigate back after success\nsetTimeout(()=>{handleClose();},3000);}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Failed to submit report');}finally{setLoading(false);}};const handleClose=()=>{navigate(-1);};const reportTypes=[{value:'INAPPROPRIATE_CONTENT',label:'Inappropriate Content'},{value:'SPAM',label:'Spam'},{value:'HARASSMENT',label:'Harassment'},{value:'MISINFORMATION',label:'Misinformation'},{value:'FRAUD',label:'Fraud or Scam'},{value:'COPYRIGHT',label:'Copyright Violation'},{value:'OTHER',label:'Other Issue'}];// Format the entity name for display\nconst getEntityName=()=>{if(!entityData)return entityType;switch(entityType.toLowerCase()){case'event':return entityData.title||entityData.name||'Event';case'user':return entityData.name||entityData.username||'User';case'product':return entityData.name||'Product';case'review':return'Review';default:return'Item';}};return/*#__PURE__*/_jsxs(Container,{maxWidth:\"md\",children:[/*#__PURE__*/_jsxs(Box,{my:4,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"Report an Issue\"}),/*#__PURE__*/_jsx(Divider,{sx:{mb:3}}),/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{p:3},children:[loadingEntity&&/*#__PURE__*/_jsx(Box,{display:\"flex\",justifyContent:\"center\",mb:3,children:/*#__PURE__*/_jsx(CircularProgress,{size:30})}),entityType&&entityId&&entityData&&/*#__PURE__*/_jsxs(Box,{mb:3,children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",gutterBottom:true,children:\"You are reporting:\"}),/*#__PURE__*/_jsxs(Paper,{variant:\"outlined\",sx:{p:2,bgcolor:'background.default'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",fontWeight:\"medium\",children:getEntityName()}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[entityType.charAt(0).toUpperCase()+entityType.slice(1).toLowerCase(),\" ID: \",entityId.substring(0,8),\"...\"]})]})]}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:3},children:error}),/*#__PURE__*/_jsx(Box,{component:\"form\",onSubmit:handleSubmitReport,children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,required:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Report Type\"}),/*#__PURE__*/_jsx(Select,{value:reportType,onChange:e=>setReportType(e.target.value),label:\"Report Type\",children:reportTypes.map(type=>/*#__PURE__*/_jsx(MenuItem,{value:type.value,children:type.label},type.value))})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{label:\"Description\",multiline:true,rows:6,value:reportDescription,onChange:e=>setReportDescription(e.target.value),fullWidth:true,required:true,placeholder:\"Please provide details about the issue...\",helperText:\"Be specific and include any relevant information that will help us investigate\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"space-between\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:handleClose,children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",disabled:loading,children:loading?'Submitting...':'Submit Report'})]})})]})})]}),/*#__PURE__*/_jsx(Box,{mt:3,children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Thank you for helping to keep our platform safe and respectful. We will review your report and take appropriate action.\"})})]}),/*#__PURE__*/_jsx(Snackbar,{open:success,autoHideDuration:3000,onClose:()=>setSuccess(false),children:/*#__PURE__*/_jsx(Alert,{severity:\"success\",sx:{width:'100%'},children:\"Report submitted successfully. Thank you!\"})})]});};export default ReportScreen;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}
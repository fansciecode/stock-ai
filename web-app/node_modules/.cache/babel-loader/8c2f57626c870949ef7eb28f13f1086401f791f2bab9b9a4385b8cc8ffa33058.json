{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useParams,useNavigate}from\"react-router-dom\";import{Box,Container,Typography,Card,CardContent,CardMedia,Button,CircularProgress,Alert,Chip,Grid,Paper,IconButton,Divider}from\"@mui/material\";import{ArrowBack,DateRange,LocationOn,Person,Category,AttachMoney,Event}from\"@mui/icons-material\";import{eventService}from\"../../services/eventService\";import{externalEventService}from\"../../services/ExternalEventService\";import\"./EventDetailsScreen.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const EventDetailsScreen=()=>{var _event$location;const{eventId}=useParams();const{source}=useParams();const navigate=useNavigate();const[event,setEvent]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{loadEventDetails();},[eventId,source]);const loadEventDetails=async()=>{try{setLoading(true);setError(null);let eventData;if(source===\"google\"||source===\"EXTERNAL\"){// Load external event\nconst response=await externalEventService.getExternalEventDetails(source||\"google\",eventId);if(response.success&&response.data){eventData=mapExternalEventToInternal(response.data);}else{throw new Error(\"Failed to load external event details\");}}else{// Load internal event\neventData=await eventService.getEventById(eventId);}setEvent(eventData);}catch(err){setError(err.message||\"Failed to load event details\");}finally{setLoading(false);}};const mapExternalEventToInternal=externalEvent=>{var _externalEvent$locati,_externalEvent$locati2,_externalEvent$locati3,_externalEvent$locati4,_externalEvent$locati5,_externalEvent$locati6,_externalEvent$photos;return{id:externalEvent.id||eventId,title:externalEvent.title||externalEvent.name||\"Untitled Event\",description:externalEvent.description||\"\",location:{address:externalEvent.address||((_externalEvent$locati=externalEvent.location)===null||_externalEvent$locati===void 0?void 0:_externalEvent$locati.address)||\"\",city:((_externalEvent$locati2=externalEvent.location)===null||_externalEvent$locati2===void 0?void 0:_externalEvent$locati2.city)||\"\",state:((_externalEvent$locati3=externalEvent.location)===null||_externalEvent$locati3===void 0?void 0:_externalEvent$locati3.state)||\"\",country:((_externalEvent$locati4=externalEvent.location)===null||_externalEvent$locati4===void 0?void 0:_externalEvent$locati4.country)||\"\",latitude:((_externalEvent$locati5=externalEvent.location)===null||_externalEvent$locati5===void 0?void 0:_externalEvent$locati5.latitude)||0,longitude:((_externalEvent$locati6=externalEvent.location)===null||_externalEvent$locati6===void 0?void 0:_externalEvent$locati6.longitude)||0,name:externalEvent.title||externalEvent.name||\"\",placeId:externalEvent.id||eventId,venue:externalEvent.venue||null},imageUrl:((_externalEvent$photos=externalEvent.photos)===null||_externalEvent$photos===void 0?void 0:_externalEvent$photos[0])||externalEvent.imageUrl||\"\",price:externalEvent.price||0,categoryId:externalEvent.category||\"external\",maxAttendees:externalEvent.maxAttendees||0,currentAttendees:externalEvent.currentAttendees||0,status:externalEvent.status||\"UPCOMING\",startDate:externalEvent.startDate||externalEvent.date||null,endDate:externalEvent.endDate||null,organizer:externalEvent.organizer||\"Unknown Organizer\",isExternal:true};};const handleBack=()=>{navigate(-1);};const handleRetry=()=>{loadEventDetails();};const formatDate=dateString=>{if(!dateString)return\"Date not specified\";try{const date=new Date(dateString);return date.toLocaleDateString(\"en-US\",{year:\"numeric\",month:\"long\",day:\"numeric\",hour:\"2-digit\",minute:\"2-digit\"});}catch(error){return dateString;}};const formatPrice=price=>{if(!price||price===0)return\"Free\";return`$${price.toFixed(2)}`;};if(loading){return/*#__PURE__*/_jsx(Box,{display:\"flex\",justifyContent:\"center\",alignItems:\"center\",minHeight:\"400px\",children:/*#__PURE__*/_jsx(CircularProgress,{size:50})});}if(error){return/*#__PURE__*/_jsxs(Container,{maxWidth:\"md\",sx:{py:4},children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",mb:2,children:[/*#__PURE__*/_jsx(IconButton,{onClick:handleBack,sx:{mr:1},children:/*#__PURE__*/_jsx(ArrowBack,{})}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",children:\"Event Details\"})]}),/*#__PURE__*/_jsx(Alert,{severity:\"error\",action:/*#__PURE__*/_jsx(Button,{color:\"inherit\",size:\"small\",onClick:handleRetry,children:\"Retry\"}),sx:{mb:2},children:error})]});}if(!event){return/*#__PURE__*/_jsxs(Container,{maxWidth:\"md\",sx:{py:4},children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",mb:2,children:[/*#__PURE__*/_jsx(IconButton,{onClick:handleBack,sx:{mr:1},children:/*#__PURE__*/_jsx(ArrowBack,{})}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",children:\"Event Details\"})]}),/*#__PURE__*/_jsx(Alert,{severity:\"info\",children:\"No event details available\"})]});}return/*#__PURE__*/_jsxs(Container,{maxWidth:\"md\",sx:{py:4},children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",mb:3,children:[/*#__PURE__*/_jsx(IconButton,{onClick:handleBack,sx:{mr:1},children:/*#__PURE__*/_jsx(ArrowBack,{})}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",component:\"h1\",children:\"Event Details\"}),event.isExternal&&/*#__PURE__*/_jsx(Chip,{label:\"External Event\",color:\"primary\",size:\"small\",sx:{ml:2}})]}),event.imageUrl&&/*#__PURE__*/_jsx(Card,{sx:{mb:3},children:/*#__PURE__*/_jsx(CardMedia,{component:\"img\",height:\"300\",image:event.imageUrl,alt:event.title,sx:{objectFit:\"cover\",borderRadius:1}})}),/*#__PURE__*/_jsxs(Paper,{elevation:2,sx:{p:3,mb:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h2\",gutterBottom:true,fontWeight:\"bold\",children:event.title}),event.description&&/*#__PURE__*/_jsx(Typography,{variant:\"body1\",color:\"text.secondary\",paragraph:true,children:event.description})]}),/*#__PURE__*/_jsxs(Paper,{elevation:2,sx:{p:3,mb:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Event Information\"}),/*#__PURE__*/_jsx(Divider,{sx:{mb:2}}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",mb:2,children:[/*#__PURE__*/_jsx(DateRange,{sx:{mr:1,color:\"primary.main\"}}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",children:\"Date & Time\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:formatDate(event.startDate)})]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",mb:2,children:[/*#__PURE__*/_jsx(LocationOn,{sx:{mr:1,color:\"primary.main\"}}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",children:\"Location\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:((_event$location=event.location)===null||_event$location===void 0?void 0:_event$location.address)||\"Location not specified\"})]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",mb:2,children:[/*#__PURE__*/_jsx(AttachMoney,{sx:{mr:1,color:\"primary.main\"}}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",children:\"Price\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:formatPrice(event.price)})]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",mb:2,children:[/*#__PURE__*/_jsx(Person,{sx:{mr:1,color:\"primary.main\"}}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",children:\"Attendees\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:event.maxAttendees>0?`${event.currentAttendees||0} / ${event.maxAttendees}`:\"No limit\"})]})]})}),event.categoryId&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",mb:2,children:[/*#__PURE__*/_jsx(Category,{sx:{mr:1,color:\"primary.main\"}}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",children:\"Category\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:event.categoryId})]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",mb:2,children:[/*#__PURE__*/_jsx(Event,{sx:{mr:1,color:\"primary.main\"}}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",color:\"text.secondary\",children:\"Status\"}),/*#__PURE__*/_jsx(Chip,{label:event.status||\"UPCOMING\",color:event.status===\"UPCOMING\"?\"success\":\"default\",size:\"small\"})]})]})})]})]}),event.organizer&&/*#__PURE__*/_jsxs(Paper,{elevation:2,sx:{p:3,mb:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Organizer\"}),/*#__PURE__*/_jsx(Divider,{sx:{mb:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:event.organizer})]}),/*#__PURE__*/_jsxs(Box,{display:\"flex\",gap:2,justifyContent:\"center\",mt:4,children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",size:\"large\",disabled:event.status===\"COMPLETED\"||event.status===\"CANCELLED\",onClick:()=>{// Handle registration/booking logic here\nconsole.log(\"Register for event:\",event.id);},children:event.price>0?\"Book Now\":\"Register\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"primary\",size:\"large\",onClick:()=>{// Handle share logic here\nif(navigator.share){navigator.share({title:event.title,text:event.description,url:window.location.href});}},children:\"Share Event\"})]})]});};export default EventDetailsScreen;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}
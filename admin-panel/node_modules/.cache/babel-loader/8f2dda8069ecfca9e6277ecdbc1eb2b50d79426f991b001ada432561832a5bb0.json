{"ast":null,"code":"import jwtDecode from'jwt-decode';import axiosInstance from'./api';class AuthService{constructor(){this.token=localStorage.getItem('adminToken');this.user=this.token?jwtDecode(this.token):null;}async login(email,password){try{const response=await axiosInstance.post('/auth/login',{email,password});const{token,user}=response.data;localStorage.setItem('adminToken',token);this.token=token;this.user=user;return user;}catch(error){var _error$response,_error$response$data;throw new Error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Login failed');}}async register(userData){try{const response=await axiosInstance.post('/auth/register',userData);return response.data;}catch(error){var _error$response2,_error$response2$data;throw new Error(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Registration failed');}}async forgotPassword(email){try{await axiosInstance.post('/auth/forgot-password',{email});return true;}catch(error){var _error$response3,_error$response3$data;throw new Error(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message)||'Password reset request failed');}}async resetPassword(token,newPassword){try{await axiosInstance.post(`/auth/reset-password/${token}`,{password:newPassword});return true;}catch(error){var _error$response4,_error$response4$data;throw new Error(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.message)||'Password reset failed');}}async verifyResetToken(token){try{const response=await axiosInstance.get(`/auth/verify-reset-token/${token}`);return response.data;}catch(error){var _error$response5,_error$response5$data;throw new Error(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.message)||'Invalid or expired token');}}async changePassword(oldPassword,newPassword){try{await axiosInstance.post('/users/change-password',{oldPassword,newPassword});return true;}catch(error){var _error$response6,_error$response6$data;throw new Error(((_error$response6=error.response)===null||_error$response6===void 0?void 0:(_error$response6$data=_error$response6.data)===null||_error$response6$data===void 0?void 0:_error$response6$data.message)||'Password change failed');}}logout(){try{axiosInstance.post('/auth/logout');}catch(error){console.error('Logout error:',error);}finally{localStorage.removeItem('adminToken');this.token=null;this.user=null;window.location.href='/login';}}isAuthenticated(){return!!this.token&&!this.isTokenExpired();}isTokenExpired(){if(!this.token)return true;try{const decoded=jwtDecode(this.token);return decoded.exp<Date.now()/1000;}catch(error){return true;}}hasPermission(permission){var _this$user,_this$user$permission;return((_this$user=this.user)===null||_this$user===void 0?void 0:(_this$user$permission=_this$user.permissions)===null||_this$user$permission===void 0?void 0:_this$user$permission.includes(permission))||false;}hasRole(role){var _this$user2,_this$user2$roles;return((_this$user2=this.user)===null||_this$user2===void 0?void 0:(_this$user2$roles=_this$user2.roles)===null||_this$user2$roles===void 0?void 0:_this$user2$roles.includes(role))||false;}getUser(){return this.user;}async refreshToken(){try{const response=await axiosInstance.post('/auth/refresh-token');const{token}=response.data;localStorage.setItem('adminToken',token);this.token=token;this.user=jwtDecode(token);return true;}catch(error){this.logout();return false;}}async updateProfile(profileData){try{const response=await axiosInstance.put('/users/profile',profileData);this.user={...this.user,...response.data};return this.user;}catch(error){var _error$response7,_error$response7$data;throw new Error(((_error$response7=error.response)===null||_error$response7===void 0?void 0:(_error$response7$data=_error$response7.data)===null||_error$response7$data===void 0?void 0:_error$response7$data.message)||'Profile update failed');}}async verifyEmail(token){try{const response=await axiosInstance.get(`/auth/verify-email/${token}`);return response.data;}catch(error){var _error$response8,_error$response8$data;throw new Error(((_error$response8=error.response)===null||_error$response8===void 0?void 0:(_error$response8$data=_error$response8.data)===null||_error$response8$data===void 0?void 0:_error$response8$data.message)||'Email verification failed');}}}// Create an instance before exporting\nconst authServiceInstance=new AuthService();export default authServiceInstance;","map":{"version":3,"names":["jwtDecode","axiosInstance","AuthService","constructor","token","localStorage","getItem","user","login","email","password","response","post","data","setItem","error","_error$response","_error$response$data","Error","message","register","userData","_error$response2","_error$response2$data","forgotPassword","_error$response3","_error$response3$data","resetPassword","newPassword","_error$response4","_error$response4$data","verifyResetToken","get","_error$response5","_error$response5$data","changePassword","oldPassword","_error$response6","_error$response6$data","logout","console","removeItem","window","location","href","isAuthenticated","isTokenExpired","decoded","exp","Date","now","hasPermission","permission","_this$user","_this$user$permission","permissions","includes","hasRole","role","_this$user2","_this$user2$roles","roles","getUser","refreshToken","updateProfile","profileData","put","_error$response7","_error$response7$data","verifyEmail","_error$response8","_error$response8$data","authServiceInstance"],"sources":["/Users/kirannaik/Desktop/zed/Android-fullstack-ibcm/admin-panel/src/services/authService.js"],"sourcesContent":["import jwtDecode from 'jwt-decode';\nimport axiosInstance from './api';\n\nclass AuthService {\n    constructor() {\n        this.token = localStorage.getItem('adminToken');\n        this.user = this.token ? jwtDecode(this.token) : null;\n    }\n\n    async login(email, password) {\n        try {\n            const response = await axiosInstance.post('/auth/login', { email, password });\n            const { token, user } = response.data;\n            \n            localStorage.setItem('adminToken', token);\n            this.token = token;\n            this.user = user;\n            \n            return user;\n        } catch (error) {\n            throw new Error(error.response?.data?.message || 'Login failed');\n        }\n    }\n\n    async register(userData) {\n        try {\n            const response = await axiosInstance.post('/auth/register', userData);\n            return response.data;\n        } catch (error) {\n            throw new Error(error.response?.data?.message || 'Registration failed');\n        }\n    }\n\n    async forgotPassword(email) {\n        try {\n            await axiosInstance.post('/auth/forgot-password', { email });\n            return true;\n        } catch (error) {\n            throw new Error(error.response?.data?.message || 'Password reset request failed');\n        }\n    }\n\n    async resetPassword(token, newPassword) {\n        try {\n            await axiosInstance.post(`/auth/reset-password/${token}`, { password: newPassword });\n            return true;\n        } catch (error) {\n            throw new Error(error.response?.data?.message || 'Password reset failed');\n        }\n    }\n\n    async verifyResetToken(token) {\n        try {\n            const response = await axiosInstance.get(`/auth/verify-reset-token/${token}`);\n            return response.data;\n        } catch (error) {\n            throw new Error(error.response?.data?.message || 'Invalid or expired token');\n        }\n    }\n\n    async changePassword(oldPassword, newPassword) {\n        try {\n            await axiosInstance.post('/users/change-password', { oldPassword, newPassword });\n            return true;\n        } catch (error) {\n            throw new Error(error.response?.data?.message || 'Password change failed');\n        }\n    }\n\n    logout() {\n        try {\n            axiosInstance.post('/auth/logout');\n        } catch (error) {\n            console.error('Logout error:', error);\n        } finally {\n            localStorage.removeItem('adminToken');\n            this.token = null;\n            this.user = null;\n            window.location.href = '/login';\n        }\n    }\n\n    isAuthenticated() {\n        return !!this.token && !this.isTokenExpired();\n    }\n\n    isTokenExpired() {\n        if (!this.token) return true;\n        try {\n            const decoded = jwtDecode(this.token);\n            return decoded.exp < Date.now() / 1000;\n        } catch (error) {\n            return true;\n        }\n    }\n\n    hasPermission(permission) {\n        return this.user?.permissions?.includes(permission) || false;\n    }\n\n    hasRole(role) {\n        return this.user?.roles?.includes(role) || false;\n    }\n\n    getUser() {\n        return this.user;\n    }\n\n    async refreshToken() {\n        try {\n            const response = await axiosInstance.post('/auth/refresh-token');\n            const { token } = response.data;\n            \n            localStorage.setItem('adminToken', token);\n            this.token = token;\n            this.user = jwtDecode(token);\n            \n            return true;\n        } catch (error) {\n            this.logout();\n            return false;\n        }\n    }\n\n    async updateProfile(profileData) {\n        try {\n            const response = await axiosInstance.put('/users/profile', profileData);\n            this.user = { ...this.user, ...response.data };\n            return this.user;\n        } catch (error) {\n            throw new Error(error.response?.data?.message || 'Profile update failed');\n        }\n    }\n\n    async verifyEmail(token) {\n        try {\n            const response = await axiosInstance.get(`/auth/verify-email/${token}`);\n            return response.data;\n        } catch (error) {\n            throw new Error(error.response?.data?.message || 'Email verification failed');\n        }\n    }\n}\n\n// Create an instance before exporting\nconst authServiceInstance = new AuthService();\nexport default authServiceInstance; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}